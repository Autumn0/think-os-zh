# 第一章 编译

> 作者：[Allen B. Downey](http://greenteapress.com/wp/)

> 原文：[Chapter 1  Compilation](http://greenteapress.com/thinkos/html/thinkos002.html)

> 译者：[飞龙](https://github.com/)

> 协议：[CC BY-NC-SA 4.0](http://creativecommons.org/licenses/by-nc-sa/4.0/)

## 1.1 编译语言和解释语言

人们通常把编程语言描述为编译语言或者解释语言。前者的意思是程序被翻译成机器语言，之后由硬件执行；而后者的意思是程序被软件解释器读取并执行。例如，C被认为是编译语言，而Python被认为是解释语言。但是二者之间的界限并不总是那么明显。

首先，许多语言既可以编译执行也可以解释执行。例如，存在C的解释器，和Python的编译器。其次，类似Java的语言混合了这两种方法，它先把程序编译成中间语言，之后在解释器中执行转换后的程序。Java使用了一种叫做“Java 字节码”的中间语言，它类似于机器语言，但是由软件解释器执行，即Java虚拟机（JVM）。

所以，编译执行或解释执行并不是语言的内在特征。尽管如此，在编译语言和解释语言之间有一些普遍的差异。

## 1.2 静态类型

许多解释语言都支持动态类型，但是编译语言通常限制为静态类型。在静态类型的语言中，你可以通过观察程序，来分辨出每个变量都指向哪种类型。在动态类型的语言中，直到运行起来，你才能知道变量的类型。通常，“静态”类型指那些在编译时发生的事情，而“动态”指在运行时发生的事情。

例如，在Python中你可以像这样编写函数：

```py
def add(x, y):
    return x + y
```

观察这段代码，你不能分辨出`x`和`y`所指向的类型。这个函数在运行时可能或调用数次，每次都接受不同类型的值。任何支持加法操作的值都能有效，任何其它类型的值都会引发异常，或者“运行时错误”。

C中你可以像这样编写同样的函数：

```c
int add(int x, int y) {
    return x + y;
}
```

函数的第一行包含了参数及返回值的“类型声明”：`x`和`y`都声明为整数，这意味着我们可以在编译时检查加法操作对该类型是否合法（是的）。返回值也声明为整数。

由于这些类型声明，当函数在程序其它位置调用时，编译器就可以检查所提供的参数是否具有正确类型，以及返回值是否使用正确。

这些检查在程序开始运行之前发生，所以可以更快地找到错误。更重要的是，程序永远不会运行的一部分中也可以找到错误。而且，这些检查不必发生于运行期间，这也是编译语言通常快于解释语言的原因之一。

编译时的类型声明也会节省空间。在动态语言中，变量的名称在程序运行时储存在内存中，并且它们通常可由程序访问。例如，在Python中，内建的`locals`函数返回含有变量名称和值的字典。下面是Python解释器中的一个示例：

```py
>>> x = 5
>>> print locals()
{'x': 5, '__builtins__': <module '__builtin__' (built-in)>,
'__name__': '__main__', '__doc__': None, '__package__': None}
```

